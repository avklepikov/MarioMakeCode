sprites.onCreated(SpriteKind.Enemy, function on_on_created(sprite: Sprite) {
    tiles.placeOnRandomTile(sprite, sprites.builtin.brick)
    sprite.vx = 20
    sprite.ay = 350
})
function setTheGame() {
    
    scene.setBackgroundImage(img`
        99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999f9999999999999999999999
        999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999f999999999999999999999999ff9999999999999999999999
        999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999ff999999999999f999f9999fff99999999999999999999999
        99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999fff99999ff9999f999999f999ff999f99999999999ff99fff9999999
        99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999f9999999f9999ff99999ff999ff999f999999999ff999999f9999999
        99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999f999ff99999ff999f9999f999999999f999999999999999
        99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999ff9999f9999ff9999ff999f99999f9999999ff999999999999999
        999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999ff9ff999f9999ff999fff999f9999ff99999ff9999f999999999999
        99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999ff999ff99fff99ff999ff999ff999fff9999ff99999ff99999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999ff99999f9999ff99ff99ff999ff999f9f999f999999999ff999999999
        99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999ff9999ffffff9ff999ff999ff999ff9999999999ff99999999
        999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999fffff9999fff9f999f9999f99999999999999999999999999
        999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999fff999f9999999f99f9999999999999999999999999999
        99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999f999999f99f9f99999f99f9f99999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999992f22f22222999f2299999999999999999999999999
        999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999422222222f22222222f229999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999944222222f222222f2222229999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999944422f2222f222222222449999999999999999999999
        9999999999999999999999999999999999999999999999119999999999999999999999999999999999999999999999999999999999999999999444422222f22222222224499999999999999999999999
        99999999999999999999999999999999999999999999911111111999999999999999999999999999999999999999999999999999999999999994444422222222f2224444449999999999999999999999
        9999999999999999999999999999999999999999999991111111119999999999999999999999999999999999999999999999999999999999994444444442222222244444429999999999999999999999
        9999999999999999999999999999999999999999999911111111111999999999999999999999999999999999999999999999999999999999994444244442442222444444429999999999999999999999
        9999999999999999999999999999999999999999999911111111111999999999999999999999999999999999999999999999999999999999944444244444444444444444422999999999999999999999
        9999999999999999999999999999999999999999999111111111111999999999999999999999999999999999999999999999999999999999444442244444444444424444442299999999999999999999
        9999999999999999999999999999999999999999999111111111111199999999999999999999999999999999999999999999999999999994444442244444444444422444444299999999999999999999
        9999999999999999999999999999999999999999991111111111111199999999999999999999999999999999999999999999999999999944444442444444444444442244444299999999999999999999
        9999999999999999999999999999999999999999911111111111111199999999999999999999999999999999999999999999999999999444444444444444444444442244444299999999999999999999
        9999999999999999999999999999999999999999111111111111111119999999999999999999999999999999999999999999999999999444424444444444244444442244444299999999999999999999
        9999999999999999999999999999999999999999111111111111111119999999999999999999999999999999999999999999999999999444424444244444224444444244444429999999999999999999
        9999999999999999999999999999999999999991111111111111111111999999999999999999999999999999999999999999999999994442244442244444224444444244444429999999999999999999
        9999999999999999999999999999999999999991111111111111111111199999999999999999999999999999999999999999999999944422244442244444222444444244444429999999999999999999
        9999999999999999999999999999999999999911111111111111111111199999999999999999999999999999999999999999999999444422244442244444222444444244444429999999999999999999
        9999999999999999999999999999999999999911111111111111111111199999999999999999999999999999999999999999999994444222444442244444422444442244444429999999999999999999
        9999999999999999999999999999999999999944411111111111111114499999999999999999999999999999999999999999999994444422444422244444422444442424444429999999999999999999
        9999999999999999999999999999999999999944411111111111111144449999999999999999999999999999999999999999999944444444444422244444422444442424444422999999999999999999
        9999999999999999999999999999999999999444444144411111111144444999999999999999999999999999999999999999999444444422444442444444422444442224444442999999999999999999
        9999999999999999999999999999999999999444444444441111411444444999999999999999999999999999999999999999994444444424444444444444422444444224444442999999999999999999
        9999999999999999999999999999999999994444444444444144444444444499999999999999999999999999999999999999944444444424444444444444442444444224444442999999999999999999
        9999999999999999999999999999999999944444444444444444444444444499999999999999999999999999999999999999444444444224444424444444442444444224444442999999999999999999
        9999999999999999999999999999999999944444444444444444444444444444999999999999999999999999999999999994444444444224444424444444444444444424444442999999999999999999
        9999999999999999999999999999999999444444444444444444444444444444499999999999999999999999999999999944444444442244444424444444244444444424444442999999999999999999
        9999999999999999999999999999999994444444444444444444444444444444449999999999999999999999999999999444444444422244444424444444244444444444444442999999999999999999
        9999999999999999999999999999999944444444444444444444444444444444444999999999999999999999999999994444444444422444444424444444244444444444444442999999999999999999
        9999999999999999999999999999999444444444444444444444444444444444444999999999999999999999999999944444444444224444444424444444244444442444444449299999999999999999
        9999999999999999999999999999994444444444444444444444444444444444444499999999999999999999999994444444444442244444444224444444244444442444444449999999999999999999
        9999999999999999999999999999944444444444444444444444444444444444444499999999999999999999999944444444444422444444444224444444244444442444444449999999999999999999
        9999999999999999999999999999444444444444444444444444444444444444444449999999999999999999999444444444444224444444444224444444244444442444444449999999999999999999
        9999999999999999999999999999444444444444444444444444444444444444444449999999999999999999994444444444422224444444442424444442244444442444444449999999999999999999
        9999999999999999999999999994444444444444444444444444444444444444444444999999999999999999944444444444422444444444442224444442244444442244444444999999999999999999
        9999999999999999999999999944444444444444444444444444444444444444444444499999999999999999444444444444224444444444424244444442244444442244444444999999999999999999
        9999999999999999999999999944444444444444444444444444444444444444444444499999999999999944444444444444444444444444424244444442244444444244444444999999999999999999
        9999999999999999999999999444444444444444444444444444444444444444444444449999999999999444444444444244444444444444222444444442244444444244444444999999999999999999
        9999999999999999999999994444444444444444444444444444444444444444444444444999999999444444444444442444444444444444222444444422244444444224444444499999999999999999
        9999999999999999999999944444444444444444444444444444444444444444444444444499999994444444444444424444444244444444224444444422244444444224444444449999999999999999
        9999999999999999999999444444444444444444444444444444444444444444444444444449999944444444444444244444442444444444224444444424244444444222444444449999999999999999
        9999999999999999999994444444444444444444444444444444444444444444444444444444999444444444444422444444442244444442424444444224244444444422444444444999999999999999
        9999999999999999999994444444444444444444444444444444444444444444444444444444994444444444444244444444442444444442424444444242444444444422244444444999999999999999
        9999999999999999999944444444444444444444444444444444444444444444444444444444444444444444442444444444422444444442224444444442444444444422244444444499999999999999
        9999999999999999999444444444444444444444444444444444444444444444444444444444444444444444224444444444424444444424224444444442444444444422224444444499999999999999
        9999999999999999994444444444444444444444444444444444444444444444444444444444444444444442444444444444424444444424224444444442244444444442422444444449999999999999
        9999999999999999944444444444444444444444444444444444444444444444444444444444444444444224444444444444224444444424224444444442244444444444244224444449999999999999
        9999999999999999444444444444444444444444444444444444444444444444444444444444444444422244444444444442244444444244224444444442244444444444424222244444999999999999
        9999999999999994444444444444444444444444444444444444444444444444444444444444444444222444444444444422444444444244224444444442244444444444442422444444449999999999
        9999999999999944444444444444444444444444444444444444444444444444444444444444444442244444444444444224444444444244224444444442224444444444444244224444449999999999
        9999999999999444444444444444444444444444444444444444444444444444444444444444444444444444444444442424444444444244244444444442422444444444444424422244444499999999
        9999999999944444444444444444444444444444444444444444444444444444444444444444444444444444444444422244444444442444244444444444222444444444444442444222444444999999
        9999999999444444444444444444444444444444444444444444444444444444444444444444444444444444444444224444444444442442244444444444224244444444444444224422244444499999
        9999999944444444444444444444444444444444444444444444444444444444444444444444444444444444444422224444444444442442244444444444422424444444444444442444222444449999
        9999994444444444444444444444444444444444444444444444444444444444444444444444444444444444444222444444444444442442244444444444422442444444444444444244422244444999
        9994444444444444444444444444444444444444444444444444444444444444444444444444444444444444442444444444444444442442444444444444442244244444444444444222442224444499
        4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444424422444444444444442244244444444444444442444244444449
        4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444224224444444444444444244424444444444444444444444444444
        4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444244244444444444444444444444444444444444444444444444444
        4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444242244444444444444444444444444444444444444444444444444
        4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444442444444444444444444444444444444444444444444444444444
        4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
        4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
        7477777777444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
        7777777777774444444477777444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
        7777777777777777777777777774444444444444444444444444444447774444444444444444444444444444444444444444444444444444444444444444444444444444444444777777777777777774
        7777777777777777777777777777774444777777777444444444477777777777444444444444777777777444444444444444444444444444444444444444444444444444447777777777777777777777
        7777777777777777777777777777777777777777777777444777777777777777777444444777777777777777777444444444444444444444444444444444444444444444777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777444444444444444444444444444444444447777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777774777777777777777777444444444777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        `)
    info.setScore(0)
    info.setLife(3)
    isHit = 0
    Level = 1
    createMap()
}

function setMario() {
    
    Mario = sprites.create(img`
            . . . . . . f f f f . . . . . .
            . . . . f f f 2 2 f f f . . . .
            . . . f f f 2 2 2 2 f f f . . .
            . . f f f e e e e e e f f f . .
            . . f f e 2 2 2 2 2 2 e e f . .
            . . f e 2 f f f f f f 2 e f . .
            . . f f f f e e e e f f f f . .
            . f f e f b f 4 4 f b f e f f .
            . f e e 4 1 f d d f 1 4 e e f .
            . . f e e d d d d d d e e f . .
            . . . f e e 4 4 4 4 e e f . . .
            . . e 4 f 2 2 2 2 2 2 f 4 e . .
            . . 4 d f 2 2 2 2 2 2 f d 4 . .
            . . 4 4 f 4 4 5 5 4 4 f 4 4 . .
            . . . . . f f f f f f . . . . .
            . . . . . f f . . f f . . . . .
            `, SpriteKind.Player)
    controller.moveSprite(Mario, 50, 0)
    Mario.ay = 300
    Mario.setStayInScreen(false)
    scene.cameraFollowSprite(Mario)
    tiles.placeOnRandomTile(Mario, assets.tile`
        myTile6
        `)
}

function createMap() {
    if (Level == 1) {
        tiles.setCurrentTilemap(tilemap`
            level1
            `)
    }
    
    if (Level == 2) {
        tiles.setCurrentTilemap(tilemap`
            level2
            `)
    }
    
    if (Level == 3) {
        game.gameOver(true)
    }
    
}

controller.A.onEvent(ControllerButtonEvent.Pressed, function on_a_pressed() {
    if (Mario.tileKindAt(TileDirection.Bottom, assets.tile`
            transparency16
            `)) {
        
    } else {
        Mario.vy = -180
        music.play(music.melodyPlayable(music.beamUp), music.PlaybackMode.InBackground)
    }
    
})
scene.onOverlapTile(SpriteKind.Player, assets.tile`
        myTile4
        `, function on_overlap_tile(sprite2: Sprite, location: tiles.Location) {
    
    pause(500)
    sprites.destroyAllSpritesOfKind(SpriteKind.Enemy)
    sprites.destroyAllSpritesOfKind(SpriteKind.Player)
    Level += 1
    createMap()
    setMario()
    createEnemies()
})
scene.onOverlapTile(SpriteKind.Player, assets.tile`
        myTile3
        `, function on_overlap_tile2(sprite3: Sprite, location2: tiles.Location) {
    
    pause(500)
    sprites.destroyAllSpritesOfKind(SpriteKind.Enemy)
    Level += 1
    createMap()
    createEnemies()
})
scene.onHitWall(SpriteKind.Enemy, function on_hit_wall(sprite4: Sprite, location3: tiles.Location) {
    if (sprite4.isHittingTile(CollisionDirection.Right)) {
        sprite4.vx = -20
    } else if (sprite4.isHittingTile(CollisionDirection.Left)) {
        sprite4.vx = 20
    }
    
})
function createEnemies() {
    
    for (let index = 0; index < 7; index++) {
        Octopus = sprites.create(img`
                ........................
                ........................
                ........................
                ........................
                ..........ffff..........
                ........ff1111ff........
                .......fb1d111dbf.......
                .......f11dd1dd1f.......
                ......fd11d1d1d1df......
                ......fd11d111d1df......
                ......fddd1111dddf......
                ......fbd7fddf7dbf......
                ......fcdc7117cdcf......
                .......fb111111bf.......
                ......fffcdb1bdffff.....
                ....fc111cbfbfc111cf....
                ....f1b1b1ffff1b1b1f....
                ....fb7b7fffffb7b7bf....
                .........ffffff.........
                ...........fff..........
                ........................
                ........................
                ........................
                ........................
                `, SpriteKind.Enemy)
    }
}

sprites.onOverlap(SpriteKind.Player, SpriteKind.Enemy, function on_on_overlap(sprite5: Sprite, otherSprite: Sprite) {
    
    if (isHit == 0) {
        isHit = 1
        info.changeLifeBy(-1)
        music.play(music.melodyPlayable(music.sonar), music.PlaybackMode.UntilDone)
    }
    
    pause(1000)
    isHit = 0
})
let Octopus : Sprite = null
let Mario : Sprite = null
let Level = 0
let isHit = 0
setTheGame()
setMario()
createEnemies()
game.onUpdate(function on_on_update() {
    if (Mario.isHittingTile(CollisionDirection.Top)) {
        if (Mario.tileKindAt(TileDirection.Top, assets.tile`
            myTile
            `)) {
            info.changeScoreBy(1)
            music.play(music.melodyPlayable(music.magicWand), music.PlaybackMode.InBackground)
            tiles.setTileAt(Mario.tilemapLocation().getNeighboringLocation(CollisionDirection.Top), sprites.builtin.brick)
        }
        
    }
    
})
game.onUpdateInterval(200, function on_update_interval() {
    
    if (Mario.isHittingTile(CollisionDirection.Bottom)) {
        if (Mario.tileKindAt(TileDirection.Bottom, assets.tile`
            myTile1
            `)) {
            Level += 1
            game.gameOver(false)
        }
        
    }
    
    if (Mario.tileKindAt(TileDirection.Bottom, sprites.castle.rock2)) {
        game.gameOver(false)
    }
    
})
